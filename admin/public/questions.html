<!DOCTYPE html>
<html>
  <head>
    <title>Admin Q&A</title>
    <style>
      body { font-family: sans-serif; padding: 20px; }
      .question { border: 1px solid #ccc; padding: 10px; margin-bottom: 15px; border-radius: 5px; }
      .question p { margin: 5px 0; }
    </style>
  </head>
  <body>
    <h1>Unanswered Questions</h1>
    <div id="questionsContainer"></div>

    <script>
      async function fetchQuestions() {
        const res = await fetch("/questions");
        const questions = await res.json();

        const container = document.getElementById("questionsContainer");
        container.innerHTML = "";

        questions.forEach((q) => {
          const div = document.createElement("div");
          div.className = "question";

          div.innerHTML = `
            <p><strong>Question:</strong> ${q.question}</p>
            <form onsubmit="return submitAnswer(event, '${q.id}')">
              <input type="text" name="answer" placeholder="Type your answer..." required style="width: 70%">
              <button type="submit">Submit</button>
            </form>
          `;

          container.appendChild(div);
        });
      }

      async function submitAnswer(event, questionId) {
        event.preventDefault();
        const answer = event.target.answer.value;

        const res = await fetch(`/questions/${questionId}/answer`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ answer }),
        });

        if (res.ok) {
          alert("Answer submitted!");
          fetchQuestions(); // refresh list
        } else {
          alert("Failed to submit answer");
        }
      }

      fetchQuestions();
    </script>
  </body>
</html>